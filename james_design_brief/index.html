<!DOCTYPE html>
<html>
    <head>
        <title>Design Brief</title>
        <script src="https://ajax.googleapis.com/ajax/libs/jquery/3.1.1/jquery.min.js"></script>
        <script src="jquery.waypoints.min.js"></script>
        <link href="https://fonts.googleapis.com/css?family=Lato" rel="stylesheet">
        <link href="https://fonts.googleapis.com/css?family=Permanent+Marker" rel="stylesheet">
        <link href="styles.css" type="text/css" rel="stylesheet">
    </head>
    <body>
        <!-- Full screen sections -->
        <div id="section1" class="fullScreenSection">
            <div class="clippingBox">
                <div class="backgroundMask"></div>
                <img src="iphone_vector.svg" class="iphone" draggable="false">
                <div class="sharpieText">Drag around phone<br>to experience in<br>Augmented Reality.
                    <img src="sharpie_text_arrow.png" draggable="false">
                </div>
            </div>
        </div>
        <div id="section2" class="fullScreenSection">
        </div>
        <div id="section3" class="fullScreenSection">
            <div class="leftContainer">
                <img src="iphone_vector_vertical.svg" class="iphone" draggable="false">
                <img src="face_mesh.svg" class="faceMesh" draggable="false">
            </div>
            <div class="rightContainer">
            </div>
        </div>
        <div id="section4" class="fullScreenSection">
        </div>
        <div id="section5" class="fullScreenSection">
        </div>
        <div id="section6" class="fullScreenSection">
        </div>
        
        <!-- Dot navigation bar on right side -->
        <ol id="sectionNav">
            <li>
                <div data-section-number="1" class="dot">
                    <div class="inner active"></div>
                    <div class="label">Augmented Reality</div>
                </div>
            </li>
            <li>
                <div data-section-number="2" class="dot">
                    <div class="inner"></div>
                    <div class="label">HUDs</div>
                </div>
            </li>
            <li>
                <div data-section-number="3" class="dot">
                    <div class="inner"></div>
                    <div class="label">Snapchat Lenses</div>
                </div>
            </li>
            <li>
                <div data-section-number="4" class="dot">
                    <div class="inner"></div>
                    <div class="label">Google Glass</div>
                </div>
            </li>
            <li>
                <div data-section-number="5" class="dot">
                    <div class="inner"></div>
                    <div class="label">Safety Concerns</div>
                </div>
            </li>
            <li>
                <div data-section-number="6" class="dot">
                    <div class="inner"></div>
                    <div class="label">Future Uses</div>
                </div>
            </li>
        </ol>
        
        <!-- Animated scroll down arrow -->
        <div id="scrollDownCaret" class="visible">
            <img src="scroll_down_caret.png" width="30" height="17">
        </div>
        
        <script type="text/javascript">
            // @media listeners
            var largeScreenStateChange = window.matchMedia("(min-width: 1400px)");
            var tinyScreenStateChange = window.matchMedia("(max-width: 700px)");
            largeScreenStateChange.addListener(updateiPhoneMaskPosition);
            tinyScreenStateChange.addListener(updateiPhoneMaskPosition);
            
            // Caret scroll-down functionality
            $("#scrollDownCaret").on("click", function() {
                $("html, body").animate({
                    scrollTop: ($("#section2").offset().top)
                },500,"swing");
            })
            
            // Section navigation dots scrolling functionality
            $("#sectionNav li .dot").on("click", function() {
                $("html, body").animate({
                    scrollTop: ($("#section" + this.getAttribute("data-section-number")).offset().top)
                },500,"swing");
                $("#sectionNav li .dot .inner").removeClass("active");
                $(this).children(".inner").addClass("active");
            })
            
            // Draggable iPhone
            function moveWithMouse(e) {
                // Every time mouse moves, update position of iPhone
                $("#section1 .iphone").css("left", (e.clientX/$(window).width())*100 + offsetX + "vw");
                $("#section1 .iphone").css("bottom", (($(window).height()-e.clientY)/$(window).height())*100 + offsetY + "vh");
                updateiPhoneMaskPosition()
            }
            $("#section1 .iphone").on("mousedown", function(e) {
                document.addEventListener("mousemove", moveWithMouse);
                // Calculate offset of mouse click in relation to iPhone, as a percent
                offsetX = (parseInt($("#section1 .iphone").css("left")) - e.clientX)*100 / $(window).width();
                offsetY = (parseInt($("#section1 .iphone").css("bottom")) - ($(window).height()-e.clientY))*100 / $(window).height();
                $("#section1 .sharpieText").fadeOut();
                $("#sectionNav").fadeOut();
                $("#scrollDownCaret").fadeOut();
                
            })
            $("#section1 .iphone").on("mouseup", function() {
                document.removeEventListener("mousemove", moveWithMouse);
                $("#sectionNav").fadeIn();
                $("#scrollDownCaret").fadeIn();
            });
            $("#section1").mouseleave(function() {
                document.removeEventListener("mousemove", moveWithMouse);
                $("#sectionNav").fadeIn();
                $("#scrollDownCaret").fadeIn();  
            });
            function updateiPhoneMaskPosition() {
                var left = (parseInt($("#section1 .iphone").css("left")) / $(window).width()) * 100;
                var bottom = (parseInt($("#section1 .iphone").css("bottom")) / $(window).height()) * 100;
                if (window.matchMedia("(max-width: 700px)").matches) {
                    // Tiny screen
                    document.getElementsByClassName("backgroundMask")[0].style.webkitClipPath = 
                        "polygon(" + (left + 2) + "% calc(" + (101 - bottom) + "% - 41.3vw), \
                        "+ (left + 82) + "% calc(" + (101 - bottom) + "% - 41.3vw), \
                        "+ (left + 82) + "% " + (99 - bottom) + "%, \
                        " + (left + 2) + "% " + (99 - bottom) + "%)"
                } else if (window.matchMedia("(min-width: 1400px)").matches) {
                    // Large screen
                    document.getElementsByClassName("backgroundMask")[0].style.webkitClipPath = 
                        "polygon(" + (left + 2) + "% calc(" + (101 - bottom) + "% - 19.7vw), \
                        "+ (left + 38) + "% calc(" + (101 - bottom) + "% - 19.7vw), \
                        "+ (left + 38) + "% " + (99 - bottom) + "%, \
                        " + (left + 2) + "% " + (99 - bottom) + "%)"
                } else {
                    // Normal-sized screen
                    document.getElementsByClassName("backgroundMask")[0].style.webkitClipPath = 
                        "polygon(" + (left + 5) + "% calc(" + (101 - bottom) + "% - 24.6vw), \
                        "+ (left + 45) + "% calc(" + (101 - bottom) + "% - 24.6vw), \
                        "+ (left + 45) + "% " + (99 - bottom) + "%, \
                        " + (left + 5) + "% " + (99 - bottom) + "%)"
                }
            }
        </script>
    </body>
</html>