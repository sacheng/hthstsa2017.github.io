<!DOCTYPE html>
<html>
    <head>
        <title>Design Brief</title>
        <script src="https://ajax.googleapis.com/ajax/libs/jquery/3.1.1/jquery.min.js"></script>
        <script src="jquery.waypoints.min.js"></script>
        <link href="https://fonts.googleapis.com/css?family=Lato" rel="stylesheet">
        <link href="https://fonts.googleapis.com/css?family=Lato:300" rel="stylesheet">
        <link href="https://fonts.googleapis.com/css?family=Lato:100" rel="stylesheet">
        <link href="https://fonts.googleapis.com/css?family=Permanent+Marker" rel="stylesheet">
        <link href="styles.css" type="text/css" rel="stylesheet">
        <link rel="stylesheet" href="animate.min.css">
    </head>
    <body>
        <!-- Full screen sections -->
        <div id="section1" class="fullScreenSection">
            <div class="clippingBox">
                <div class="backgroundMask"></div>
                <img src="iphone_vector.svg" class="iphone" draggable="false">
                <div class="sharpieText">Drag around phone<br>to experience in<br>Augmented Reality.
                    <img src="sharpie_text_arrow.png" draggable="false">
                </div>
            </div>
        </div>
        <div id="section2" class="fullScreenSection">
        </div>
        <div id="section3" class="fullScreenSection">
            <div class="leftContainer">
                <img src="iphone_vector_vertical.svg" class="iphone" draggable="false">
                <img src="face_mesh.svg" class="faceMesh" draggable="false">
            </div>
            <div class="rightContainer">
                <div class="content">
                    <span class="title">Snapchat Lense Filters</span>
                    <div class="subtitleLine"></div>
                    <div class="subtitle animated" id="subtitle1">Augmented Reality?</div>
                    <div class="subtitle animated noOpacity" id="subtitle2">Analyzing the Image</div>
                    <div class="subtitle animated noOpacity" id="subtitle3">Adding the Effect</div>
                    <div class="subtitle animated noOpacity" id="subtitle4">Heading 4</div>
                    <div class="buttonContainer">
                        <div class="circle"></div>
                        <div data-section-number="1" class="btn"></div>
                        <div data-section-number="2" class="btn"></div>
                        <div data-section-number="3" class="btn"></div>
                        <div data-section-number="4" class="btn"></div>
                    </div>
                    <div id="text1" class="text animated">
                        Snapchat is a photo-sharing application that was first launched in September 2011. It enables users to take and send photos and short videos that automatically delete after a set amount of time. Beginning in September 2015, Snapchat incorporated augmented reality into the experience through a feature called Lense Filters. Lense Filters add real-time special effects to images and have rapidly grown in popularity since their addition.
                    </div>
                    <div id="text2" class="text animated hidden">
                        text 2 Blah blah blah blah blah blah blah blah blah blah blah blah blah blah blah blah blah blah blah blah blah blah
                    </div>
                    <div id="text3" class="text animated hidden">
                        text 3 Blah blah blah blah blah blah blah blah blah blah blah blah blah blah blah blah blah blah blah blah blah blah
                    </div>
                    <div id="text4" class="text animated hidden">
                        text 4Blah blah blah blah blah blah blah blah blah blah blah blah blah blah blah blah blah blah blah blah blah blah
                    </div>
                </div>
            </div>
        </div>
        <div id="section4" class="fullScreenSection">
        </div>
        <div id="section5" class="fullScreenSection">
        </div>
        <div id="section6" class="fullScreenSection">
        </div>
        
        <!-- Dot navigation bar on right side -->
        <ol id="sectionNav">
            <li>
                <div data-section-number="1" id="dot1" class="dot">
                    <div class="inner active"></div>
                    <div class="label">Augmented Reality</div>
                </div>
            </li>
            <li>
                <div data-section-number="2" id="dot2" class="dot">
                    <div class="inner"></div>
                    <div class="label">HUDs</div>
                </div>
            </li>
            <li>
                <div data-section-number="3" id="dot3" class="dot">
                    <div class="inner"></div>
                    <div class="label">Snapchat Lenses</div>
                </div>
            </li>
            <li>
                <div data-section-number="4" id="dot4" class="dot">
                    <div class="inner"></div>
                    <div class="label">Google Glass</div>
                </div>
            </li>
            <li>
                <div data-section-number="5" id="dot5" class="dot">
                    <div class="inner"></div>
                    <div class="label">Safety Concerns</div>
                </div>
            </li>
            <li>
                <div data-section-number="6" id="dot6" class="dot">
                    <div class="inner"></div>
                    <div class="label">Future Uses</div>
                </div>
            </li>
        </ol>
        
        <!-- Animated scroll down arrow -->
        <div id="scrollDownCaret" class="visible">
            <img src="scroll_down_caret.png" width="30" height="17">
        </div>
        
        <script type="text/javascript">
            $.fn.extend({
                animateCss: function (animationName) {
                    $(this).removeClass('noOpacity');
                    var animationEnd = 'webkitAnimationEnd mozAnimationEnd MSAnimationEnd oanimationend animationend';
                    this.addClass('animated ' + animationName).one(animationEnd, function() {
                        $(this).removeClass('animated ' + animationName);
                    });
                }
            });
            
            // @media listeners
            var largeScreenStateChange = window.matchMedia("(min-width: 1400px)");
            var tinyScreenStateChange = window.matchMedia("(max-width: 700px)");
            largeScreenStateChange.addListener(updateiPhoneMaskPosition);
            tinyScreenStateChange.addListener(updateiPhoneMaskPosition);
            
            updateSectionScrollPositions();
            $(window).on("resize", updateSectionScrollPositions);
            function updateSectionScrollPositions() {
                var heightOffset = $(window).height() / 2;
                scroll1 = heightOffset;
                scroll2 = $("#section2").offset().top + heightOffset;
                scroll3 = $("#section3").offset().top + heightOffset;
                scroll4 = $("#section4").offset().top + heightOffset;
                scroll5 = $("#section5").offset().top + heightOffset;
                scroll6 = $("#section6").offset().top + heightOffset;
            }
            
            $(window).on("scroll", function() {
                var currentScroll = $(window).scrollTop();
                if (currentScroll > 50) {
                    $("#scrollDownCaret").fadeOut();
                } else {
                    $("#scrollDownCaret").fadeIn();
                }
                if (currentScroll < scroll1) {
                    // Section1
                    $("#sectionNav li .dot .inner").removeClass("active");
                    $("#sectionNav li #dot1 .inner").addClass("active");
                } else if (currentScroll > scroll1 && currentScroll < scroll2) {
                    // Section2
                    $("#sectionNav li .dot .inner").removeClass("active");
                    $("#sectionNav li #dot2 .inner").addClass("active");
                } else if (currentScroll > scroll2 && currentScroll < scroll3) {
                    // Section3
                    $("#sectionNav li .dot .inner").removeClass("active");
                    $("#sectionNav li #dot3 .inner").addClass("active");
                } else if (currentScroll > scroll3 && currentScroll < scroll4) {
                    // Section4
                    $("#sectionNav li .dot .inner").removeClass("active");
                    $("#sectionNav li #dot4 .inner").addClass("active");
                } else if (currentScroll > scroll4 && currentScroll < scroll5) {
                    // Section5
                    $("#sectionNav li .dot .inner").removeClass("active");
                    $("#sectionNav li #dot5 .inner").addClass("active");
                } else if (currentScroll > scroll5 && currentScroll < scroll6) {
                    // Section6
                    $("#sectionNav li .dot .inner").removeClass("active");
                    $("#sectionNav li #dot6 .inner").addClass("active");
                }
            });
            
            // Caret scroll-down functionality
            $("#scrollDownCaret").on("click", function() {
                $("html, body").animate({
                    scrollTop: ($("#section2").offset().top)
                },500,"swing");
            })
            
            // Section navigation dots scrolling functionality
            $("#sectionNav li .dot").on("click", function() {
                $("html, body").animate({
                    scrollTop: ($("#section" + this.getAttribute("data-section-number")).offset().top)
                },500,"swing");
                $("#sectionNav li .dot .inner").removeClass("active");
                $(this).children(".inner").addClass("active");
            })
            
            // Draggable iPhone
            function moveWithMouse(e) {
                // Every time mouse moves, update position of iPhone
                $("#section1 .iphone").css("left", (e.clientX/$(window).width())*100 + offsetX + "vw");
                $("#section1 .iphone").css("bottom", (($(window).height()-e.clientY)/$(window).height())*100 + offsetY + "vh");
                updateiPhoneMaskPosition()
            }
            $("#section1 .iphone").on("mousedown", function(e) {
                document.addEventListener("mousemove", moveWithMouse);
                // Calculate offset of mouse click in relation to iPhone, as a percent
                offsetX = (parseInt($("#section1 .iphone").css("left")) - e.clientX)*100 / $(window).width();
                offsetY = (parseInt($("#section1 .iphone").css("bottom")) - ($(window).height()-e.clientY))*100 / $(window).height();
                $("#section1 .sharpieText").fadeOut();
                $("#sectionNav").fadeOut();
                $("#scrollDownCaret").fadeOut();
                
            })
            $("#section1 .iphone").on("mouseup", function() {
                document.removeEventListener("mousemove", moveWithMouse);
                $("#sectionNav").fadeIn();
                $("#scrollDownCaret").fadeIn();
            });
            $("#section1").mouseleave(function() {
                document.removeEventListener("mousemove", moveWithMouse);
                $("#sectionNav").fadeIn();
                if ($(window).scrollTop() < 40) {
                    $("#scrollDownCaret").fadeIn();
                }
            });
            function updateiPhoneMaskPosition() {
                var left = (parseInt($("#section1 .iphone").css("left")) / $(window).width()) * 100;
                var bottom = (parseInt($("#section1 .iphone").css("bottom")) / $(window).height()) * 100;
                if (window.matchMedia("(max-width: 700px)").matches) {
                    // Tiny screen
                    document.getElementsByClassName("backgroundMask")[0].style.webkitClipPath = 
                        "polygon(" + (left + 2) + "% calc(" + (101 - bottom) + "% - 41.3vw), \
                        "+ (left + 82) + "% calc(" + (101 - bottom) + "% - 41.3vw), \
                        "+ (left + 82) + "% " + (99 - bottom) + "%, \
                        " + (left + 2) + "% " + (99 - bottom) + "%)"
                } else if (window.matchMedia("(min-width: 1400px)").matches) {
                    // Large screen
                    document.getElementsByClassName("backgroundMask")[0].style.webkitClipPath = 
                        "polygon(" + (left + 2) + "% calc(" + (101 - bottom) + "% - 19.7vw), \
                        "+ (left + 38) + "% calc(" + (101 - bottom) + "% - 19.7vw), \
                        "+ (left + 38) + "% " + (99 - bottom) + "%, \
                        " + (left + 2) + "% " + (99 - bottom) + "%)"
                } else {
                    // Normal-sized screen
                    document.getElementsByClassName("backgroundMask")[0].style.webkitClipPath = 
                        "polygon(" + (left + 5) + "% calc(" + (101 - bottom) + "% - 24.6vw), \
                        "+ (left + 45) + "% calc(" + (101 - bottom) + "% - 24.6vw), \
                        "+ (left + 45) + "% " + (99 - bottom) + "%, \
                        " + (left + 5) + "% " + (99 - bottom) + "%)"
                }
            }
            
            // Number buttons and text fading in/out
            currentSection = 1;
            var leftValues = [-1, 28.5, 58, 87.5];
            $("#section3 .rightContainer .btn").on("click touch", function() {
                var sectionNumber = this.getAttribute("data-section-number")
                $("#section3 .rightContainer .circle").animate({
                    left: leftValues[sectionNumber - 1] + "%"
                },400,"swing");
                if (sectionNumber - currentSection > 0) {
                    $("#subtitle" + currentSection).animateCss("fadeOutLeft");
                    $("#subtitle" + currentSection).addClass("noOpacity");
                    $("#subtitle" + sectionNumber).animateCss("fadeInRight");
                    $("#text" + currentSection).fadeOut();
                    $("#text" + sectionNumber).fadeIn();
                } else if (sectionNumber - currentSection < 0) {
                    $("#subtitle" + currentSection).animateCss("fadeOutRight");
                    $("#subtitle" + currentSection).addClass("noOpacity");
                    $("#subtitle" + sectionNumber).animateCss("fadeInLeft");
                    $("#text" + currentSection).fadeOut();
                    $("#text" + sectionNumber).fadeIn();
                }
                currentSection = sectionNumber;
            });
        </script>
    </body>
</html>